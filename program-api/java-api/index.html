<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="

  Java API
  #


  
If possible, recommend using computing engines such as Flink SQL or Spark SQL.




  Dependency
  #

Maven dependency:">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://lss1231.github.io/paimon-docs-chinese/program-api/java-api/">
  <meta property="og:site_name" content="Paimon Docs">
  <meta property="og:title" content="Java API">
  <meta property="og:description" content="Java API#If possible, recommend using computing engines such as Flink SQL or Spark SQL.Dependency#Maven dependency:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="program-api">
<title>Java API | Paimon Docs</title>
<link rel="icon" href="/paimon-docs-chinese/favicon.png" >
<link rel="manifest" href="/paimon-docs-chinese/manifest.json">
<link rel="canonical" href="https://lss1231.github.io/paimon-docs-chinese/program-api/java-api/">
  <link rel="alternate" hreflang="zh" href="https://lss1231.github.io/paimon-docs-chinese/zh/program-api/java-api/" title="Java API">
<link rel="stylesheet" href="/paimon-docs-chinese/book.min.d5e59cb0aa8d22a5813c62cd5e25d3d172489a369c61dc3f622ee96ae1ebb457.css" integrity="sha256-1eWcsKqNIqWBPGLNXiXT0XJImjacYdw/Yi7pauHrtFc=" crossorigin="anonymous">
  <script defer src="/paimon-docs-chinese/fuse.min.js"></script>
  <script defer src="/paimon-docs-chinese/en.search.min.aaf551d0fd2d15700c7cc1367efc5e1f0877e9fa20ee85f422be6d5ab52f12a7.js" integrity="sha256-qvVR0P0tFXAMfME2fvxeHwh36fog7oX0Ir5tWrUvEqc=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/paimon-docs-chinese/"><span>Paimon Docs</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>



  



  
    
  


  


<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex">
      <a role="button" class="flex flex-auto">
        <img src="/paimon-docs-chinese/svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </label>

    <ul>
      
      <li>
        <a href="/paimon-docs-chinese/zh/program-api/java-api/">
          简体中文
        </a>
      </li>
      
    </ul>
  </li>
</ul>














  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b895d453a63bdabdecfee3e52661076a" class="toggle"  />
    <label for="section-b895d453a63bdabdecfee3e52661076a" class="flex">
      <a href="/paimon-docs-chinese/concepts/" class="flex-auto ">Concepts</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/basic-concepts/" class="">Basic Concepts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/concurrency-control/" class="">Concurrency Control</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/catalog/" class="">Catalog</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3f7756e5a365d9799e1a48e9dc082791" class="toggle"  />
    <label for="section-3f7756e5a365d9799e1a48e9dc082791" class="flex">
      <a href="/paimon-docs-chinese/concepts/rest/" class="flex-auto ">RESTCatalog</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/rest/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/rest/bear/" class="">Bear Token</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/rest/dlf/" class="">DLF Token</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/rest/rest-api/" class="">REST API</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/table-types/" class="">Table Types</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/system-tables/" class="">System Tables</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/data-types/" class="">Data Types</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-518e0eab49b8a9fb8a84a1463b02c8ec" class="toggle"  />
    <label for="section-518e0eab49b8a9fb8a84a1463b02c8ec" class="flex">
      <a href="/paimon-docs-chinese/concepts/spec/" class="flex-auto ">Specification</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/spec/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/spec/schema/" class="">Schema</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/spec/snapshot/" class="">Snapshot</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/spec/manifest/" class="">Manifest</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/spec/datafile/" class="">DataFile</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/spec/tableindex/" class="">Table Index</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/concepts/spec/fileindex/" class="">File Index</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a59fccf91e43460927bdd7cd6969595c" class="toggle"  />
    <label for="section-a59fccf91e43460927bdd7cd6969595c" class="flex">
      <a href="/paimon-docs-chinese/primary-key-table/" class="flex-auto ">Table with PK</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/data-distribution/" class="">Data Distribution</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/table-mode/" class="">Table Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9f5fa7a57eda74541859925935ec1ee1" class="toggle"  />
    <label for="section-9f5fa7a57eda74541859925935ec1ee1" class="flex">
      <a href="/paimon-docs-chinese/primary-key-table/merge-engine/" class="flex-auto ">Merge Engine</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/merge-engine/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/merge-engine/partial-update/" class="">Partial Update</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/merge-engine/aggregation/" class="">Aggregation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/merge-engine/first-row/" class="">First Row</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/changelog-producer/" class="">Changelog Producer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/sequence-rowkind/" class="">Sequence &amp; Rowkind</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/compaction/" class="">Compaction</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/primary-key-table/query-performance/" class="">Query Performance</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d9fb3aa2654140cef78254b873df57fa" class="toggle"  />
    <label for="section-d9fb3aa2654140cef78254b873df57fa" class="flex">
      <a href="/paimon-docs-chinese/append-table/" class="flex-auto ">Table w/o PK</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/append-table/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/append-table/streaming/" class="">Streaming</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/append-table/query-performance/" class="">Query Performance</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/append-table/update/" class="">Update</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/append-table/bucketed/" class="">Bucketed</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1dcd5659f5f5eb616ea2a1af4d1ac5b6" class="toggle"  />
    <label for="section-1dcd5659f5f5eb616ea2a1af4d1ac5b6" class="flex">
      <a href="/paimon-docs-chinese/flink/" class="flex-auto ">Engine Flink</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/quick-start/" class="">Quick Start</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/sql-ddl/" class="">SQL DDL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/sql-write/" class="">SQL Write</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/sql-query/" class="">SQL Query</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/consumer-id/" class="">Consumer ID</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/sql-lookup/" class="">SQL Lookup</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/sql-alter/" class="">SQL Alter</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/clone-tables/" class="">Clone Tables</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/procedures/" class="">Procedures</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/action-jars/" class="">Action Jars</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/flink/savepoint/" class="">Savepoint</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3816fb91454c9575f5905fe48381df74" class="toggle"  />
    <label for="section-3816fb91454c9575f5905fe48381df74" class="flex">
      <a href="/paimon-docs-chinese/spark/" class="flex-auto ">Engine Spark</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/spark/quick-start/" class="">Quick Start</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/spark/sql-ddl/" class="">SQL DDL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/spark/sql-functions/" class="">SQL Functions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/spark/sql-write/" class="">SQL Write</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/spark/sql-query/" class="">SQL Query</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/spark/sql-alter/" class="">SQL Alter</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/spark/auxiliary/" class="">Auxiliary</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/spark/procedures/" class="">Procedures</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4ea9d84ff168bffb367b5a8863787431" class="toggle"  />
    <label for="section-4ea9d84ff168bffb367b5a8863787431" class="flex">
      <a href="/paimon-docs-chinese/ecosystem/" class="flex-auto ">Ecosystem</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/ecosystem/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/ecosystem/starrocks/" class="">StarRocks</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/ecosystem/doris/" class="">Doris</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/ecosystem/hive/" class="">Hive</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/ecosystem/trino/" class="">Trino</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/ecosystem/amoro/" class="">Amoro</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f8080595b1d8c7471fe9dac6513e4716" class="toggle"  />
    <label for="section-f8080595b1d8c7471fe9dac6513e4716" class="flex">
      <a href="/paimon-docs-chinese/cdc-ingestion/" class="flex-auto ">CDC Ingestion</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/cdc-ingestion/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/cdc-ingestion/mysql-cdc/" class="">Mysql CDC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/cdc-ingestion/postgres-cdc/" class="">Postgres CDC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/cdc-ingestion/kafka-cdc/" class="">Kafka CDC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/cdc-ingestion/mongo-cdc/" class="">Mongo CDC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/cdc-ingestion/pulsar-cdc/" class="">Pulsar CDC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/cdc-ingestion/debezium-bson/" class="">Debezium BSON</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2fd5175453dec9b599669fc6e1204624" class="toggle"  />
    <label for="section-2fd5175453dec9b599669fc6e1204624" class="flex">
      <a href="/paimon-docs-chinese/maintenance/" class="flex-auto ">Maintenance</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/filesystems/" class="">Filesystems</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/write-performance/" class="">Write Performance</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/dedicated-compaction/" class="">Dedicated Compaction</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/manage-snapshots/" class="">Manage Snapshots</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/rescale-bucket/" class="">Rescale Bucket</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/manage-tags/" class="">Manage Tags</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/metrics/" class="">Metrics</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/manage-privileges/" class="">Manage Privileges</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/manage-branches/" class="">Manage Branches</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/manage-partitions/" class="">Manage Partitions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/maintenance/configurations/" class="">Configurations</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-974644b076e3505ee3b189288c66d89f" class="toggle" checked />
    <label for="section-974644b076e3505ee3b189288c66d89f" class="flex">
      <a href="/paimon-docs-chinese/program-api/" class="flex-auto ">Program API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/program-api/flink-api/" class="">Flink API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/program-api/java-api/" class="active">Java API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/program-api/catalog-api/" class="">Catalog API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/program-api/python-api/" class="">Python API</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e474e2510a937257fb60b059694394da" class="toggle"  />
    <label for="section-e474e2510a937257fb60b059694394da" class="flex">
      <a href="/paimon-docs-chinese/migration/" class="flex-auto ">Migration</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/migration/migration-from-hive/" class="">Migration From Hive</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/migration/migration-from-iceberg/" class="">Migration From Iceberg</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/migration/upsert-to-partitioned/" class="">Upsert To Partitioned</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/migration/iceberg-compatibility/" class="">Iceberg Compatibility</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d016a6a1825abcee27e3240dd658e135" class="toggle"  />
    <label for="section-d016a6a1825abcee27e3240dd658e135" class="flex">
      <a href="/paimon-docs-chinese/project/" class="flex-auto ">Project</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/project/roadmap/" class="">Roadmap</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/project/download/" class="">Download</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/project/contributing/" class="">Contributing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/project/committer/" class="">Committer</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b300129f24651283095ddcb6c7d1d5b8" class="toggle"  />
    <label for="section-b300129f24651283095ddcb6c7d1d5b8" class="flex">
      <a href="/paimon-docs-chinese/learn-paimon/" class="flex-auto ">Learn Paimon</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/paimon-docs-chinese/learn-paimon/understand-files/" class="">Understand Files</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/paimon-docs-chinese/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Java API</h3>

  <label for="toc-control">
    
    <img src="/paimon-docs-chinese/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>

  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#dependency">Dependency</a></li>
    <li><a href="#create-catalog">Create Catalog</a></li>
    <li><a href="#create-table">Create Table</a></li>
    <li><a href="#get-table">Get Table</a></li>
    <li><a href="#batch-read">Batch Read</a></li>
    <li><a href="#batch-write">Batch Write</a></li>
    <li><a href="#stream-read">Stream Read</a></li>
    <li><a href="#stream-write">Stream Write</a></li>
    <li><a href="#data-types">Data Types</a></li>
    <li><a href="#predicate-types">Predicate Types</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<h1 id="java-api">
  Java API
  <a class="anchor" href="#java-api">#</a>
</h1>
<blockquote class="book-hint info">
  
If possible, recommend using computing engines such as Flink SQL or Spark SQL.

</blockquote>

<h2 id="dependency">
  Dependency
  <a class="anchor" href="#dependency">#</a>
</h2>
<p>Maven dependency:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.paimon<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;artifactId&gt;</span>paimon-bundle<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;version&gt;</span>1.1.1<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>Or download the jar file:
<a href="https://repo.maven.apache.org/maven2/org/apache/paimon/paimon-bundle/1.1.1/paimon-bundle-1.1.1.jar">Paimon Bundle</a>.


</p>
<p>Paimon relies on Hadoop environment, you should add hadoop classpath or bundled jar.</p>
<h2 id="create-catalog">
  Create Catalog
  <a class="anchor" href="#create-catalog">#</a>
</h2>
<p>Before coming into contact with the Table, you need to create a Catalog.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.catalog.Catalog;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.catalog.CatalogContext;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.catalog.CatalogFactory;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.fs.Path;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.options.Options;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CreateCatalog</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Catalog <span style="color:#a6e22e">createFilesystemCatalog</span>() {
</span></span><span style="display:flex;"><span>        CatalogContext context <span style="color:#f92672">=</span> CatalogContext.<span style="color:#a6e22e">create</span>(<span style="color:#66d9ef">new</span> Path(<span style="color:#e6db74">&#34;...&#34;</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> CatalogFactory.<span style="color:#a6e22e">createCatalog</span>(context);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Catalog <span style="color:#a6e22e">createHiveCatalog</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Paimon Hive catalog relies on Hive jars</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// You should add hive classpath or hive bundled jar.</span>
</span></span><span style="display:flex;"><span>        Options options <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Options();
</span></span><span style="display:flex;"><span>        options.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#34;warehouse&#34;</span>, <span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>        options.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#34;metastore&#34;</span>, <span style="color:#e6db74">&#34;hive&#34;</span>);
</span></span><span style="display:flex;"><span>        options.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#34;uri&#34;</span>, <span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>        options.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#34;hive-conf-dir&#34;</span>, <span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>        options.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#34;hadoop-conf-dir&#34;</span>, <span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>        CatalogContext context <span style="color:#f92672">=</span> CatalogContext.<span style="color:#a6e22e">create</span>(options);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> CatalogFactory.<span style="color:#a6e22e">createCatalog</span>(context);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="create-table">
  Create Table
  <a class="anchor" href="#create-table">#</a>
</h2>
<p>You can use the catalog to create tables. The created tables are persistence in the file system.
Next time you can directly obtain these tables.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.catalog.Catalog;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.catalog.Identifier;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.schema.Schema;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.types.DataTypes;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CreateTable</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        Schema.<span style="color:#a6e22e">Builder</span> schemaBuilder <span style="color:#f92672">=</span> Schema.<span style="color:#a6e22e">newBuilder</span>();
</span></span><span style="display:flex;"><span>        schemaBuilder.<span style="color:#a6e22e">primaryKey</span>(<span style="color:#e6db74">&#34;f0&#34;</span>, <span style="color:#e6db74">&#34;f1&#34;</span>);
</span></span><span style="display:flex;"><span>        schemaBuilder.<span style="color:#a6e22e">partitionKeys</span>(<span style="color:#e6db74">&#34;f1&#34;</span>);
</span></span><span style="display:flex;"><span>        schemaBuilder.<span style="color:#a6e22e">column</span>(<span style="color:#e6db74">&#34;f0&#34;</span>, DataTypes.<span style="color:#a6e22e">STRING</span>());
</span></span><span style="display:flex;"><span>        schemaBuilder.<span style="color:#a6e22e">column</span>(<span style="color:#e6db74">&#34;f1&#34;</span>, DataTypes.<span style="color:#a6e22e">INT</span>());
</span></span><span style="display:flex;"><span>        Schema schema <span style="color:#f92672">=</span> schemaBuilder.<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Identifier identifier <span style="color:#f92672">=</span> Identifier.<span style="color:#a6e22e">create</span>(<span style="color:#e6db74">&#34;my_db&#34;</span>, <span style="color:#e6db74">&#34;my_table&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            Catalog catalog <span style="color:#f92672">=</span> CreateCatalog.<span style="color:#a6e22e">createFilesystemCatalog</span>();
</span></span><span style="display:flex;"><span>            catalog.<span style="color:#a6e22e">createTable</span>(identifier, schema, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (Catalog.<span style="color:#a6e22e">TableAlreadyExistException</span> e) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// do something</span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (Catalog.<span style="color:#a6e22e">DatabaseNotExistException</span> e) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// do something</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="get-table">
  Get Table
  <a class="anchor" href="#get-table">#</a>
</h2>
<p>The <code>Table</code> interface provides access to the table metadata and tools to read and write table.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.catalog.Catalog;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.catalog.Identifier;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.Table;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GetTable</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Table <span style="color:#a6e22e">getTable</span>() {
</span></span><span style="display:flex;"><span>        Identifier identifier <span style="color:#f92672">=</span> Identifier.<span style="color:#a6e22e">create</span>(<span style="color:#e6db74">&#34;my_db&#34;</span>, <span style="color:#e6db74">&#34;my_table&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            Catalog catalog <span style="color:#f92672">=</span> CreateCatalog.<span style="color:#a6e22e">createFilesystemCatalog</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> catalog.<span style="color:#a6e22e">getTable</span>(identifier);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (Catalog.<span style="color:#a6e22e">TableNotExistException</span> e) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// do something</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException(<span style="color:#e6db74">&#34;table not exist&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="batch-read">
  Batch Read
  <a class="anchor" href="#batch-read">#</a>
</h2>
<p>For relatively small amounts of data, or for data that has undergone projection and filtering,
you can directly use a standalone program to read the table data.</p>
<p>But if the data volume of the table is relatively large, you can distribute splits to different tasks for reading.</p>
<p>The reading is divided into two stages:</p>
<ol>
<li>Scan Plan: Generate plan splits in a global node (&lsquo;Coordinator&rsquo;, or named &lsquo;Driver&rsquo;).</li>
<li>Read Split: Read split in distributed tasks.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.data.InternalRow;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.predicate.Predicate;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.predicate.PredicateBuilder;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.reader.RecordReader;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.Table;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.source.ReadBuilder;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.source.Split;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.source.TableRead;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.types.DataTypes;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.types.RowType;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.google.common.collect.Lists;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.List;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ReadTable</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 1. Create a ReadBuilder and push filter (`withFilter`)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// and projection (`withProjection`) if necessary</span>
</span></span><span style="display:flex;"><span>        Table table <span style="color:#f92672">=</span> GetTable.<span style="color:#a6e22e">getTable</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        PredicateBuilder builder <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> PredicateBuilder(RowType.<span style="color:#a6e22e">of</span>(DataTypes.<span style="color:#a6e22e">STRING</span>(), DataTypes.<span style="color:#a6e22e">INT</span>()));
</span></span><span style="display:flex;"><span>        Predicate notNull <span style="color:#f92672">=</span> builder.<span style="color:#a6e22e">isNotNull</span>(0);
</span></span><span style="display:flex;"><span>        Predicate greaterOrEqual <span style="color:#f92672">=</span> builder.<span style="color:#a6e22e">greaterOrEqual</span>(1, 12);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> projection <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> {0, 1};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ReadBuilder readBuilder <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            table.<span style="color:#a6e22e">newReadBuilder</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">withProjection</span>(projection)
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">withFilter</span>(Lists.<span style="color:#a6e22e">newArrayList</span>(notNull, greaterOrEqual));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 2. Plan splits in &#39;Coordinator&#39; (or named &#39;Driver&#39;)</span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Split<span style="color:#f92672">&gt;</span> splits <span style="color:#f92672">=</span> readBuilder.<span style="color:#a6e22e">newScan</span>().<span style="color:#a6e22e">plan</span>().<span style="color:#a6e22e">splits</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 3. Distribute these splits to different tasks</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 4. Read a split in task</span>
</span></span><span style="display:flex;"><span>        TableRead read <span style="color:#f92672">=</span> readBuilder.<span style="color:#a6e22e">newRead</span>();
</span></span><span style="display:flex;"><span>        RecordReader<span style="color:#f92672">&lt;</span>InternalRow<span style="color:#f92672">&gt;</span> reader <span style="color:#f92672">=</span> read.<span style="color:#a6e22e">createReader</span>(splits);
</span></span><span style="display:flex;"><span>        reader.<span style="color:#a6e22e">forEachRemaining</span>(System.<span style="color:#a6e22e">out</span>::println);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="batch-write">
  Batch Write
  <a class="anchor" href="#batch-write">#</a>
</h2>
<p>The writing is divided into two stages:</p>
<ol>
<li>Write records: Write records in distributed tasks, generate commit messages.</li>
<li>Commit/Abort: Collect all CommitMessages, commit them in a global node (&lsquo;Coordinator&rsquo;, or named &lsquo;Driver&rsquo;, or named &lsquo;Committer&rsquo;).
When the commit fails for certain reason, abort unsuccessful commit via CommitMessages.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.data.BinaryString;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.data.GenericRow;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.Table;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.sink.BatchTableCommit;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.sink.BatchTableWrite;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.sink.BatchWriteBuilder;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.sink.CommitMessage;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.List;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BatchWrite</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 1. Create a WriteBuilder (Serializable)</span>
</span></span><span style="display:flex;"><span>        Table table <span style="color:#f92672">=</span> GetTable.<span style="color:#a6e22e">getTable</span>();
</span></span><span style="display:flex;"><span>        BatchWriteBuilder writeBuilder <span style="color:#f92672">=</span> table.<span style="color:#a6e22e">newBatchWriteBuilder</span>().<span style="color:#a6e22e">withOverwrite</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 2. Write records in distributed tasks</span>
</span></span><span style="display:flex;"><span>        BatchTableWrite write <span style="color:#f92672">=</span> writeBuilder.<span style="color:#a6e22e">newWrite</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        GenericRow record1 <span style="color:#f92672">=</span> GenericRow.<span style="color:#a6e22e">of</span>(BinaryString.<span style="color:#a6e22e">fromString</span>(<span style="color:#e6db74">&#34;Alice&#34;</span>), 12);
</span></span><span style="display:flex;"><span>        GenericRow record2 <span style="color:#f92672">=</span> GenericRow.<span style="color:#a6e22e">of</span>(BinaryString.<span style="color:#a6e22e">fromString</span>(<span style="color:#e6db74">&#34;Bob&#34;</span>), 5);
</span></span><span style="display:flex;"><span>        GenericRow record3 <span style="color:#f92672">=</span> GenericRow.<span style="color:#a6e22e">of</span>(BinaryString.<span style="color:#a6e22e">fromString</span>(<span style="color:#e6db74">&#34;Emily&#34;</span>), 18);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// If this is a distributed write, you can use writeBuilder.newWriteSelector.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// WriteSelector determines to which logical downstream writers a record should be written to.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// If it returns empty, no data distribution is required.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        write.<span style="color:#a6e22e">write</span>(record1);
</span></span><span style="display:flex;"><span>        write.<span style="color:#a6e22e">write</span>(record2);
</span></span><span style="display:flex;"><span>        write.<span style="color:#a6e22e">write</span>(record3);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>CommitMessage<span style="color:#f92672">&gt;</span> messages <span style="color:#f92672">=</span> write.<span style="color:#a6e22e">prepareCommit</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 3. Collect all CommitMessages to a global node and commit</span>
</span></span><span style="display:flex;"><span>        BatchTableCommit commit <span style="color:#f92672">=</span> writeBuilder.<span style="color:#a6e22e">newCommit</span>();
</span></span><span style="display:flex;"><span>        commit.<span style="color:#a6e22e">commit</span>(messages);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Abort unsuccessful commit to delete data files</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// commit.abort(messages);</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="stream-read">
  Stream Read
  <a class="anchor" href="#stream-read">#</a>
</h2>
<p>The difference of Stream Read is that StreamTableScan can continuously scan and generate splits.</p>
<p>StreamTableScan provides the ability to checkpoint and restore, which can let you save the correct state
during stream reading.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.data.InternalRow;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.predicate.Predicate;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.predicate.PredicateBuilder;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.reader.RecordReader;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.Table;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.source.ReadBuilder;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.source.Split;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.source.StreamTableScan;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.source.TableRead;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.types.DataTypes;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.types.RowType;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.google.common.collect.Lists;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.List;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StreamReadTable</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 1. Create a ReadBuilder and push filter (`withFilter`)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// and projection (`withProjection`) if necessary</span>
</span></span><span style="display:flex;"><span>        Table table <span style="color:#f92672">=</span> GetTable.<span style="color:#a6e22e">getTable</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        PredicateBuilder builder <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> PredicateBuilder(RowType.<span style="color:#a6e22e">of</span>(DataTypes.<span style="color:#a6e22e">STRING</span>(), DataTypes.<span style="color:#a6e22e">INT</span>()));
</span></span><span style="display:flex;"><span>        Predicate notNull <span style="color:#f92672">=</span> builder.<span style="color:#a6e22e">isNotNull</span>(0);
</span></span><span style="display:flex;"><span>        Predicate greaterOrEqual <span style="color:#f92672">=</span> builder.<span style="color:#a6e22e">greaterOrEqual</span>(1, 12);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> projection <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> {0, 1};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ReadBuilder readBuilder <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            table.<span style="color:#a6e22e">newReadBuilder</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">withProjection</span>(projection)
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">withFilter</span>(Lists.<span style="color:#a6e22e">newArrayList</span>(notNull, greaterOrEqual));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 2. Plan splits in &#39;Coordinator&#39; (or named &#39;Driver&#39;)</span>
</span></span><span style="display:flex;"><span>        StreamTableScan scan <span style="color:#f92672">=</span> readBuilder.<span style="color:#a6e22e">newStreamScan</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            List<span style="color:#f92672">&lt;</span>Split<span style="color:#f92672">&gt;</span> splits <span style="color:#f92672">=</span> scan.<span style="color:#a6e22e">plan</span>().<span style="color:#a6e22e">splits</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Distribute these splits to different tasks</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            Long state <span style="color:#f92672">=</span> scan.<span style="color:#a6e22e">checkpoint</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// can be restored in scan.restore(state) after fail over</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 3. Read a split in task</span>
</span></span><span style="display:flex;"><span>            TableRead read <span style="color:#f92672">=</span> readBuilder.<span style="color:#a6e22e">newRead</span>();
</span></span><span style="display:flex;"><span>            RecordReader<span style="color:#f92672">&lt;</span>InternalRow<span style="color:#f92672">&gt;</span> reader <span style="color:#f92672">=</span> read.<span style="color:#a6e22e">createReader</span>(splits);
</span></span><span style="display:flex;"><span>            reader.<span style="color:#a6e22e">forEachRemaining</span>(System.<span style="color:#a6e22e">out</span>::println);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            Thread.<span style="color:#a6e22e">sleep</span>(1000);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="stream-write">
  Stream Write
  <a class="anchor" href="#stream-write">#</a>
</h2>
<p>The difference of Stream Write is that StreamTableCommit can continuously commit.</p>
<p>Key points to achieve exactly-once consistency:</p>
<ul>
<li>CommitUser represents a user. A user can commit multiple times. In distributed processing, you are
expected to use the same commitUser.</li>
<li>Different applications need to use different commitUsers.</li>
<li>The commitIdentifier of <code>StreamTableWrite</code> and <code>StreamTableCommit</code> needs to be consistent, and the
id needs to be incremented for the next committing.</li>
<li>When a failure occurs, if you still have uncommitted <code>CommitMessage</code>s, please use <code>StreamTableCommit#filterAndCommit</code>
to exclude the committed messages by commitIdentifier.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.data.BinaryString;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.data.GenericRow;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.Table;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.sink.CommitMessage;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.sink.StreamTableCommit;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.sink.StreamTableWrite;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.paimon.table.sink.StreamWriteBuilder;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.List;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StreamWriteTable</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 1. Create a WriteBuilder (Serializable)</span>
</span></span><span style="display:flex;"><span>        Table table <span style="color:#f92672">=</span> GetTable.<span style="color:#a6e22e">getTable</span>();
</span></span><span style="display:flex;"><span>        StreamWriteBuilder writeBuilder <span style="color:#f92672">=</span> table.<span style="color:#a6e22e">newStreamWriteBuilder</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 2. Write records in distributed tasks</span>
</span></span><span style="display:flex;"><span>        StreamTableWrite write <span style="color:#f92672">=</span> writeBuilder.<span style="color:#a6e22e">newWrite</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// commitIdentifier like Flink checkpointId</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">long</span> commitIdentifier <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            GenericRow record1 <span style="color:#f92672">=</span> GenericRow.<span style="color:#a6e22e">of</span>(BinaryString.<span style="color:#a6e22e">fromString</span>(<span style="color:#e6db74">&#34;Alice&#34;</span>), 12);
</span></span><span style="display:flex;"><span>            GenericRow record2 <span style="color:#f92672">=</span> GenericRow.<span style="color:#a6e22e">of</span>(BinaryString.<span style="color:#a6e22e">fromString</span>(<span style="color:#e6db74">&#34;Bob&#34;</span>), 5);
</span></span><span style="display:flex;"><span>            GenericRow record3 <span style="color:#f92672">=</span> GenericRow.<span style="color:#a6e22e">of</span>(BinaryString.<span style="color:#a6e22e">fromString</span>(<span style="color:#e6db74">&#34;Emily&#34;</span>), 18);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// If this is a distributed write, you can use writeBuilder.newWriteSelector.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// WriteSelector determines to which logical downstream writers a record should be written to.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// If it returns empty, no data distribution is required.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            write.<span style="color:#a6e22e">write</span>(record1);
</span></span><span style="display:flex;"><span>            write.<span style="color:#a6e22e">write</span>(record2);
</span></span><span style="display:flex;"><span>            write.<span style="color:#a6e22e">write</span>(record3);
</span></span><span style="display:flex;"><span>            List<span style="color:#f92672">&lt;</span>CommitMessage<span style="color:#f92672">&gt;</span> messages <span style="color:#f92672">=</span> write.<span style="color:#a6e22e">prepareCommit</span>(<span style="color:#66d9ef">false</span>, commitIdentifier);
</span></span><span style="display:flex;"><span>            commitIdentifier<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 3. Collect all CommitMessages to a global node and commit</span>
</span></span><span style="display:flex;"><span>            StreamTableCommit commit <span style="color:#f92672">=</span> writeBuilder.<span style="color:#a6e22e">newCommit</span>();
</span></span><span style="display:flex;"><span>            commit.<span style="color:#a6e22e">commit</span>(commitIdentifier, messages);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 4. When failure occurs and you&#39;re not sure if the commit process is successful,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//    you can use `filterAndCommit` to retry the commit process.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//    Succeeded commits will be automatically skipped.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">            Map&lt;Long, List&lt;CommitMessage&gt;&gt; commitIdentifiersAndMessages = new HashMap&lt;&gt;();
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">            commitIdentifiersAndMessages.put(commitIdentifier, messages);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">            commit.filterAndCommit(commitIdentifiersAndMessages);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">            */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            Thread.<span style="color:#a6e22e">sleep</span>(1000);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="data-types">
  Data Types
  <a class="anchor" href="#data-types">#</a>
</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Java</th>
          <th style="text-align: left">Paimon</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">boolean</td>
          <td style="text-align: left">boolean</td>
      </tr>
      <tr>
          <td style="text-align: left">byte</td>
          <td style="text-align: left">byte</td>
      </tr>
      <tr>
          <td style="text-align: left">short</td>
          <td style="text-align: left">short</td>
      </tr>
      <tr>
          <td style="text-align: left">int</td>
          <td style="text-align: left">int</td>
      </tr>
      <tr>
          <td style="text-align: left">long</td>
          <td style="text-align: left">long</td>
      </tr>
      <tr>
          <td style="text-align: left">float</td>
          <td style="text-align: left">float</td>
      </tr>
      <tr>
          <td style="text-align: left">double</td>
          <td style="text-align: left">double</td>
      </tr>
      <tr>
          <td style="text-align: left">string</td>
          <td style="text-align: left">org.apache.paimon.data.BinaryString</td>
      </tr>
      <tr>
          <td style="text-align: left">decimal</td>
          <td style="text-align: left">org.apache.paimon.data.Decimal</td>
      </tr>
      <tr>
          <td style="text-align: left">timestamp</td>
          <td style="text-align: left">org.apache.paimon.data.Timestamp</td>
      </tr>
      <tr>
          <td style="text-align: left">byte[]</td>
          <td style="text-align: left">byte[]</td>
      </tr>
      <tr>
          <td style="text-align: left">array</td>
          <td style="text-align: left">org.apache.paimon.data.InternalArray</td>
      </tr>
      <tr>
          <td style="text-align: left">map</td>
          <td style="text-align: left">org.apache.paimon.data.InternalMap</td>
      </tr>
      <tr>
          <td style="text-align: left">InternalRow</td>
          <td style="text-align: left">org.apache.paimon.data.InternalRow</td>
      </tr>
  </tbody>
</table>
<h2 id="predicate-types">
  Predicate Types
  <a class="anchor" href="#predicate-types">#</a>
</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">SQL Predicate</th>
          <th style="text-align: left">Paimon Predicate</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">and</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.And</td>
      </tr>
      <tr>
          <td style="text-align: left">or</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.Or</td>
      </tr>
      <tr>
          <td style="text-align: left">is null</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.IsNull</td>
      </tr>
      <tr>
          <td style="text-align: left">is not null</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.IsNotNull</td>
      </tr>
      <tr>
          <td style="text-align: left">in</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.In</td>
      </tr>
      <tr>
          <td style="text-align: left">not in</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.NotIn</td>
      </tr>
      <tr>
          <td style="text-align: left">=</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.Equal</td>
      </tr>
      <tr>
          <td style="text-align: left">&lt;&gt;</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.NotEqual</td>
      </tr>
      <tr>
          <td style="text-align: left">&lt;</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.LessThan</td>
      </tr>
      <tr>
          <td style="text-align: left">&lt;=</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.LessOrEqual</td>
      </tr>
      <tr>
          <td style="text-align: left">&gt;</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.GreaterThan</td>
      </tr>
      <tr>
          <td style="text-align: left">&gt;=</td>
          <td style="text-align: left">org.apache.paimon.predicate.PredicateBuilder.GreaterOrEqual</td>
      </tr>
  </tbody>
</table>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#dependency">Dependency</a></li>
    <li><a href="#create-catalog">Create Catalog</a></li>
    <li><a href="#create-table">Create Table</a></li>
    <li><a href="#get-table">Get Table</a></li>
    <li><a href="#batch-read">Batch Read</a></li>
    <li><a href="#batch-write">Batch Write</a></li>
    <li><a href="#stream-read">Stream Read</a></li>
    <li><a href="#stream-write">Stream Write</a></li>
    <li><a href="#data-types">Data Types</a></li>
    <li><a href="#predicate-types">Predicate Types</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












